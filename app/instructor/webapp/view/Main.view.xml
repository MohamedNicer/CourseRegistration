<mvc:View
    controllerName="instructor.controller.Main"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    height="100%">
    
    <Page title="Instructor Portal" showNavButton="true" navButtonPress=".onNavBack">
        <headerContent>
            <Button icon="sap-icon://log" text="Logout" press=".onLogout" type="Transparent"/>
        </headerContent>
        <content>
            <VBox>
                <!-- Header -->
                <Panel class="instructorHeader sapUiResponsiveMargin">
                    <VBox>
                        <Title text="Welcome, {profile>/firstName} {profile>/lastName}" level="H2" class="instructorTitle"/>
                        <Text text="{profile>/email}"/>
                        <Text text="{profile>/departmentName}"/>
                    </VBox>
                </Panel>
                
                <!-- Tab Bar -->
                <IconTabBar id="iconTabBar" select=".onTabSelect" class="sapUiResponsiveMargin">
                    
                    <!-- My Courses Tab -->
                    <items>
                        <IconTabFilter text="My Courses" key="courses" icon="sap-icon://course-book">
                            <VBox class="sapUiSmallMargin">
                                <Title text="Courses I Teach" level="H2" class="sapUiSmallMarginBottom"/>
                                
                                <Table
                                    id="courseTable"
                                    growing="true"
                                    growingThreshold="15"
                                    growingScrollToLoad="false"
                                    items="{
                                        path: 'courses>/courses',
                                        length: 10000
                                    }">
                                    <columns>
                                        <Column width="12%">
                                            <Text text="Code"/>
                                        </Column>
                                        <Column width="30%">
                                            <Text text="Course Name"/>
                                        </Column>
                                        <Column width="8%">
                                            <Text text="ECTS"/>
                                        </Column>
                                        <Column width="15%">
                                            <Text text="Semester"/>
                                        </Column>
                                        <Column width="20%">
                                            <Text text="Department"/>
                                        </Column>
                                        <Column width="15%">
                                            <Text text="Enrollments"/>
                                        </Column>
                                    </columns>
                                    <items>
                                        <ColumnListItem>
                                            <cells>
                                                <Text text="{courses>courseCode}"/>
                                                <Text text="{courses>courseName}"/>
                                                <Text text="{courses>ects}"/>
                                                <Text text="{courses>semester}"/>
                                                <Text text="{courses>departmentName}"/>
                                                <Text text="{courses>enrolled} / {courses>quota}"/>
                                            </cells>
                                        </ColumnListItem>
                                    </items>
                                </Table>
                            </VBox>
                        </IconTabFilter>
                        
                        <!-- Enrollments Tab -->
                        <IconTabFilter text="Enrollments" key="enrollments" icon="sap-icon://education">
                            <VBox class="sapUiSmallMargin">
                                <Title text="Student Enrollments" level="H2" class="sapUiSmallMarginBottom"/>
                                
                                <Table
                                    id="enrollmentTable"
                                    growing="true"
                                    growingThreshold="15"
                                    growingScrollToLoad="false"
                                    items="{
                                        path: 'enrollments>/enrollments',
                                        length: 10000
                                    }">
                                    <columns>
                                        <Column width="15%">
                                            <Text text="Student Name"/>
                                        </Column>
                                        <Column width="12%">
                                            <Text text="Student Number"/>
                                        </Column>
                                        <Column width="18%">
                                            <Text text="Email"/>
                                        </Column>
                                        <Column width="12%">
                                            <Text text="Course Code"/>
                                        </Column>
                                        <Column width="18%">
                                            <Text text="Course Name"/>
                                        </Column>
                                        <Column width="10%">
                                            <Text text="Status"/>
                                        </Column>
                                        <Column width="10%">
                                            <Text text="Grade"/>
                                        </Column>
                                        <Column width="5%">
                                            <Text text=""/>
                                        </Column>
                                    </columns>
                                    <items>
                                        <ColumnListItem>
                                            <cells>
                                                <Text text="{enrollments>student/firstName} {enrollments>student/lastName}"/>
                                                <Text text="{enrollments>student/studentNumber}"/>
                                                <Text text="{enrollments>student/email}"/>
                                                <Text text="{enrollments>course/courseCode}"/>
                                                <Text text="{enrollments>course/courseName}"/>
                                                <ObjectStatus 
                                                    text="{enrollments>status}"
                                                    state="{parts: [{path: 'enrollments>status', targetType: 'any'}], formatter: '.formatStatusState'}"/>
                                                <Input 
                                                    value="{enrollments>grade}"
                                                    class="gradeInput"
                                                    placeholder="Enter grade"/>
                                                <Button 
                                                    icon="sap-icon://save"
                                                    type="Emphasized"
                                                    press=".onUpdateGrade"
                                                    tooltip="Save Grade"/>
                                            </cells>
                                        </ColumnListItem>
                                    </items>
                                </Table>
                            </VBox>
                        </IconTabFilter>
                        
                        <!-- Statistics Tab -->
                        <IconTabFilter text="Statistics" key="statistics" icon="sap-icon://bar-chart">
                            <VBox class="sapUiSmallMargin">
                                <Title text="Teaching Analytics" level="H2" class="sapUiSmallMarginBottom"/>
                                
                                <!-- Course Capacity Chart -->
                                <Panel headerText="Course Enrollment Overview" class="sapUiResponsiveMargin">
                                    <core:HTML content="&lt;canvas id='instructorCourseCapacityChart' style='width: 100%; height: 300px;'&gt;&lt;/canvas&gt;"/>
                                </Panel>
                                
                                <!-- Grade Distribution Chart -->
                                <Panel headerText="Grade Distribution" class="sapUiResponsiveMargin">
                                    <core:HTML content="&lt;canvas id='instructorGradeChart' style='width: 100%; height: 300px;'&gt;&lt;/canvas&gt;"/>
                                </Panel>
                                
                                <!-- Enrollment Status Chart -->
                                <Panel headerText="Enrollment Status" class="sapUiResponsiveMargin">
                                    <core:HTML content="&lt;canvas id='instructorStatusChart' style='width: 100%; height: 250px;'&gt;&lt;/canvas&gt;"/>
                                </Panel>
                            </VBox>
                        </IconTabFilter>
                    </items>
                </IconTabBar>
            </VBox>
        </content>
    </Page>
</mvc:View>
