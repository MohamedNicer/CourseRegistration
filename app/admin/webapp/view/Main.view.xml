<mvc:View
    controllerName="admin.controller.Main"
    xmlns:mvc="sap.ui.core.mvc"
    xmlns="sap.m"
    xmlns:core="sap.ui.core"
    xmlns:html="http://www.w3.org/1999/xhtml"
    height="100%">
    
    <Page title="Admin Portal" showNavButton="true" navButtonPress=".onNavBack">
        <headerContent>
            <Button icon="sap-icon://log" text="Logout" press=".onLogout" type="Transparent"/>
        </headerContent>
        <content>
            <VBox>
                <!-- Header -->
                <Panel class="adminHeader sapUiResponsiveMargin">
                    <VBox>
                        <Title text="Administrator Dashboard" level="H2" class="adminTitle"/>
                        <Text text="{profile>/name}" class="adminProfileText sapUiSmallMarginBottom"/>
                        <Text text="{profile>/email}" class="adminProfileText"/>
                    </VBox>
                </Panel>
                
                <!-- Tab Bar -->
                <IconTabBar id="iconTabBar" select=".onTabSelect" class="sapUiResponsiveMargin">
                    
                    <!-- Students Tab -->
                    <items>
                        <IconTabFilter text="Students" key="students" icon="sap-icon://group">
                            <VBox class="sapUiSmallMargin">
                                <!-- Analytics Section -->
                                <Panel headerText="Student Analytics" class="sapUiSmallMarginBottom">
                                    <HBox>
                                        <VBox width="50%" class="sapUiSmallMarginEnd">
                                            <core:HTML content="&lt;canvas id='studentDeptChart' style='width: 100%; height: 250px;'&gt;&lt;/canvas&gt;"/>
                                        </VBox>
                                        <VBox width="50%">
                                            <core:HTML content="&lt;canvas id='studentStatsChart' style='width: 100%; height: 250px;'&gt;&lt;/canvas&gt;"/>
                                        </VBox>
                                    </HBox>
                                </Panel>
                                
                                <!-- CRUD Toolbar -->
                                <Toolbar>
                                    <Title text="All Students" level="H3"/>
                                    <ToolbarSpacer/>
                                    <ComboBox
                                        width="200px"
                                        placeholder="Filter by Department"
                                        selectionChange=".onFilterStudentsByDepartment"
                                        class="sapUiSmallMarginEnd"
                                        items="{departments>/}">
                                        <core:Item key="" text="All Departments" />
                                        <core:Item key="{departments>ID}" text="{departments>departmentName}" />
                                    </ComboBox>
                                    <SearchField
                                        width="300px"
                                        placeholder="Search students..."
                                        liveChange=".onSearchStudents"
                                        class="sapUiSmallMarginEnd"/>
                                    <Button text="Add Student" icon="sap-icon://add" type="Emphasized" press=".onAddStudent"/>
                                </Toolbar>
                                
                                <Table
                                    id="studentTable"
                                    mode="SingleSelectMaster"
                                    growing="true"
                                    growingThreshold="15"
                                    growingScrollToLoad="false"
                                    items="{
                                        path: 'students>/students',
                                        length: 10000
                                    }">
                                    <columns>
                                        <Column width="10%">
                                            <Text text="Student #"/>
                                        </Column>
                                        <Column width="18%">
                                            <Text text="Name"/>
                                        </Column>
                                        <Column width="22%">
                                            <Text text="Email"/>
                                        </Column>
                                        <Column width="15%">
                                            <Text text="Department"/>
                                        </Column>
                                        <Column width="15%">
                                            <Text text="Faculty"/>
                                        </Column>
                                        <Column width="10%">
                                            <Text text="ECTS Limit"/>
                                        </Column>
                                        <Column width="10%">
                                            <Text text="Actions"/>
                                        </Column>
                                    </columns>
                                    <items>
                                        <ColumnListItem>
                                            <cells>
                                                <Text text="{students>studentNumber}"/>
                                                <Text text="{students>firstName} {students>lastName}"/>
                                                <Text text="{students>email}"/>
                                                <Text text="{students>department/departmentName}"/>
                                                <Text text="{students>department/faculty}"/>
                                                <Text text="{students>ectsLimit}"/>
                                                <HBox>
                                                    <Button icon="sap-icon://edit" type="Transparent" press=".onEditStudent"/>
                                                    <Button icon="sap-icon://delete" type="Transparent" press=".onDeleteStudent"/>
                                                </HBox>
                                            </cells>
                                        </ColumnListItem>
                                    </items>
                                </Table>
                            </VBox>
                        </IconTabFilter>
                        
                        <!-- Instructors Tab -->
                        <IconTabFilter text="Instructors" key="instructors" icon="sap-icon://employee">
                            <VBox class="sapUiSmallMargin">
                                <!-- Analytics Section -->
                                <Panel headerText="Instructor Analytics" class="sapUiSmallMarginBottom">
                                    <HBox>
                                        <VBox width="50%" class="sapUiSmallMarginEnd">
                                            <core:HTML content="&lt;canvas id='instructorDeptChart' style='width: 100%; height: 250px;'&gt;&lt;/canvas&gt;"/>
                                        </VBox>
                                        <VBox width="50%">
                                            <core:HTML content="&lt;canvas id='instructorStatsChart' style='width: 100%; height: 250px;'&gt;&lt;/canvas&gt;"/>
                                        </VBox>
                                    </HBox>
                                </Panel>
                                
                                <!-- CRUD Toolbar -->
                                <Toolbar>
                                    <Title text="All Instructors" level="H3"/>
                                    <ToolbarSpacer/>
                                    <ComboBox
                                        width="200px"
                                        placeholder="Filter by Department"
                                        selectionChange=".onFilterInstructorsByDepartment"
                                        class="sapUiSmallMarginEnd"
                                        items="{departments>/}">
                                        <core:Item key="" text="All Departments" />
                                        <core:Item key="{departments>ID}" text="{departments>departmentName}" />
                                    </ComboBox>
                                    <SearchField
                                        width="300px"
                                        placeholder="Search instructors..."
                                        liveChange=".onSearchInstructors"
                                        class="sapUiSmallMarginEnd"/>
                                    <Button text="Add Instructor" icon="sap-icon://add" type="Emphasized" press=".onAddInstructor"/>
                                </Toolbar>
                                
                                <Table
                                    id="instructorTable"
                                    mode="SingleSelectMaster"
                                    growing="true"
                                    growingThreshold="15"
                                    growingScrollToLoad="false"
                                    items="{
                                        path: 'instructors>/instructors',
                                        length: 10000
                                    }">
                                    <columns>
                                        <Column width="15%">
                                            <Text text="Instructor ID"/>
                                        </Column>
                                        <Column width="25%">
                                            <Text text="Name"/>
                                        </Column>
                                        <Column width="30%">
                                            <Text text="Email"/>
                                        </Column>
                                        <Column width="20%">
                                            <Text text="Department"/>
                                        </Column>
                                        <Column width="10%">
                                            <Text text="Actions"/>
                                        </Column>
                                    </columns>
                                    <items>
                                        <ColumnListItem>
                                            <cells>
                                                <Text text="{instructors>instructorId}"/>
                                                <Text text="{instructors>firstName} {instructors>lastName}"/>
                                                <Text text="{instructors>email}"/>
                                                <Text text="{instructors>department/departmentName}"/>
                                                <HBox>
                                                    <Button icon="sap-icon://edit" type="Transparent" press=".onEditInstructor"/>
                                                    <Button icon="sap-icon://delete" type="Transparent" press=".onDeleteInstructor"/>
                                                </HBox>
                                            </cells>
                                        </ColumnListItem>
                                    </items>
                                </Table>
                            </VBox>
                        </IconTabFilter>
                        
                        <!-- Courses Tab -->
                        <IconTabFilter text="Courses" key="courses" icon="sap-icon://course-book">
                            <VBox class="sapUiSmallMargin">
                                <!-- Analytics Section -->
                                <Panel headerText="Course Analytics" class="sapUiSmallMarginBottom">
                                    <HBox>
                                        <VBox width="50%" class="sapUiSmallMarginEnd">
                                            <core:HTML content="&lt;canvas id='courseDeptChart' style='width: 100%; height: 250px;'&gt;&lt;/canvas&gt;"/>
                                        </VBox>
                                        <VBox width="50%">
                                            <core:HTML content="&lt;canvas id='courseCapacityChart' style='width: 100%; height: 250px;'&gt;&lt;/canvas&gt;"/>
                                        </VBox>
                                    </HBox>
                                </Panel>
                                
                                <!-- CRUD Toolbar -->
                                <Toolbar>
                                    <Title text="All Courses" level="H3"/>
                                    <ToolbarSpacer/>
                                    <ComboBox
                                        width="200px"
                                        placeholder="Filter by Department"
                                        selectionChange=".onFilterCoursesByDepartment"
                                        class="sapUiSmallMarginEnd"
                                        items="{departments>/}">
                                        <core:Item key="" text="All Departments" />
                                        <core:Item key="{departments>ID}" text="{departments>departmentName}" />
                                    </ComboBox>
                                    <ComboBox
                                        width="180px"
                                        placeholder="Filter by Status"
                                        selectionChange=".onFilterCoursesByStatus"
                                        class="sapUiSmallMarginEnd">
                                        <core:Item key="" text="All Courses" />
                                        <core:Item key="true" text="Active Only" />
                                        <core:Item key="false" text="Inactive Only" />
                                    </ComboBox>
                                    <SearchField
                                        width="300px"
                                        placeholder="Search courses..."
                                        liveChange=".onSearchCourses"
                                        class="sapUiSmallMarginEnd"/>
                                    <Button text="Add Course" icon="sap-icon://add" type="Emphasized" press=".onAddCourse"/>
                                </Toolbar>
                                
                                <Table
                                    id="courseTable"
                                    mode="SingleSelectMaster"
                                    growing="true"
                                    growingThreshold="15"
                                    growingScrollToLoad="false"
                                    items="{
                                        path: 'courses>/courses',
                                        length: 10000
                                    }">
                                    <columns>
                                        <Column width="8%">
                                            <Text text="Code"/>
                                        </Column>
                                        <Column width="18%">
                                            <Text text="Course Name"/>
                                        </Column>
                                        <Column width="5%">
                                            <Text text="ECTS"/>
                                        </Column>
                                        <Column width="10%">
                                            <Text text="Semester"/>
                                        </Column>
                                        <Column width="13%">
                                            <Text text="Department"/>
                                        </Column>
                                        <Column width="15%">
                                            <Text text="Instructor"/>
                                        </Column>
                                        <Column width="8%">
                                            <Text text="Quota"/>
                                        </Column>
                                        <Column width="8%">
                                            <Text text="Active"/>
                                        </Column>
                                        <Column width="10%">
                                            <Text text="Actions"/>
                                        </Column>
                                    </columns>
                                    <items>
                                        <ColumnListItem>
                                            <cells>
                                                <Text text="{courses>courseCode}"/>
                                                <Text text="{courses>courseName}"/>
                                                <Text text="{courses>ects}"/>
                                                <Text text="{courses>semester}"/>
                                                <Text text="{courses>department/departmentName}"/>
                                                <Text text="{courses>instructor/firstName} {courses>instructor/lastName}"/>
                                                <Text text="{courses>enrolled} / {courses>quota}"/>
                                                <ObjectStatus 
                                                    text="{parts: [{path: 'courses>isActive', targetType: 'any'}], formatter: '.formatActiveText'}"
                                                    state="{parts: [{path: 'courses>isActive', targetType: 'any'}], formatter: '.formatActiveState'}"/>
                                                <HBox>
                                                    <Button icon="sap-icon://edit" type="Transparent" press=".onEditCourse"/>
                                                    <Button icon="sap-icon://delete" type="Transparent" press=".onDeleteCourse"/>
                                                </HBox>
                                            </cells>
                                        </ColumnListItem>
                                    </items>
                                </Table>
                            </VBox>
                        </IconTabFilter>
                        
                        <!-- Enrollments Tab -->
                        <IconTabFilter text="Enrollments" key="enrollments" icon="sap-icon://education">
                            <VBox class="sapUiSmallMargin">
                                <!-- Analytics Section -->
                                <Panel headerText="Enrollment Analytics" class="sapUiSmallMarginBottom">
                                    <HBox>
                                        <VBox width="50%" class="sapUiSmallMarginEnd">
                                            <core:HTML content="&lt;canvas id='enrollmentStatusChart' style='width: 100%; height: 250px;'&gt;&lt;/canvas&gt;"/>
                                        </VBox>
                                        <VBox width="50%">
                                            <core:HTML content="&lt;canvas id='enrollmentTrendChart' style='width: 100%; height: 250px;'&gt;&lt;/canvas&gt;"/>
                                        </VBox>
                                    </HBox>
                                </Panel>
                                
                                <!-- CRUD Toolbar -->
                                <Toolbar>
                                    <Title text="All Enrollments" level="H3"/>
                                    <ToolbarSpacer/>
                                    <ComboBox
                                        width="180px"
                                        placeholder="Filter by Status"
                                        selectionChange=".onFilterEnrollmentsByStatus"
                                        class="sapUiSmallMarginEnd">
                                        <core:Item key="" text="All Statuses" />
                                        <core:Item key="ENROLLED" text="Enrolled" />
                                        <core:Item key="COMPLETED" text="Completed" />
                                        <core:Item key="DROPPED" text="Dropped" />
                                        <core:Item key="EXCELLENT" text="Excellent" />
                                        <core:Item key="VERY_GOOD" text="Very Good" />
                                        <core:Item key="GOOD" text="Good" />
                                        <core:Item key="SATISFACTORY" text="Satisfactory" />
                                        <core:Item key="PASSED" text="Passed" />
                                        <core:Item key="FAILED" text="Failed" />
                                    </ComboBox>
                                    <SearchField
                                        width="300px"
                                        placeholder="Search enrollments..."
                                        liveChange=".onSearchEnrollments"
                                        class="sapUiSmallMarginEnd"/>
                                    <Button text="Add Enrollment" icon="sap-icon://add" type="Emphasized" press=".onAddEnrollment"/>
                                </Toolbar>
                                
                                <Table
                                    id="enrollmentTable"
                                    mode="SingleSelectMaster"
                                    growing="true"
                                    growingThreshold="15"
                                    growingScrollToLoad="false"
                                    items="{
                                        path: 'enrollments>/enrollments',
                                        length: 10000
                                    }">
                                    <columns>
                                        <Column width="25%">
                                            <Text text="Student Name"/>
                                        </Column>
                                        <Column width="12%">
                                            <Text text="Course Code"/>
                                        </Column>
                                        <Column width="25%">
                                            <Text text="Course Name"/>
                                        </Column>
                                        <Column width="13%">
                                            <Text text="Status"/>
                                        </Column>
                                        <Column width="10%">
                                            <Text text="Grade"/>
                                        </Column>
                                        <Column width="10%">
                                            <Text text="Actions"/>
                                        </Column>
                                    </columns>
                                    <items>
                                        <ColumnListItem>
                                            <cells>
                                                <Text text="{enrollments>student/firstName} {enrollments>student/lastName}"/>
                                                <Text text="{enrollments>course/courseCode}"/>
                                                <Text text="{enrollments>course/courseName}"/>
                                                <ObjectStatus 
                                                    text="{enrollments>status}"
                                                    state="{parts: [{path: 'enrollments>status', targetType: 'any'}], formatter: '.formatStatusState'}"/>
                                                <Text text="{enrollments>grade}"/>
                                                <HBox>
                                                    <Button icon="sap-icon://edit" type="Transparent" press=".onEditEnrollment"/>
                                                    <Button icon="sap-icon://delete" type="Transparent" press=".onDeleteEnrollment"/>
                                                </HBox>
                                            </cells>
                                        </ColumnListItem>
                                    </items>
                                </Table>
                            </VBox>
                        </IconTabFilter>
                    </items>
                </IconTabBar>
            </VBox>
        </content>
    </Page>
</mvc:View>
